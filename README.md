# vAIlentin 2.0 Bot

Telegram –±–æ—Ç —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã
- **–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º** (`/shutdown`) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ–π –±–æ—Ç–∞ –≤–æ –≤—Å–µ—Ö —á–∞—Ç–∞—Ö
- **–†–µ–∂–∏–º —á–∞—Ç–∞** (`/setmode`) - –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –±–æ—Ç–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —á–∞—Ç–µ
- **–£–º–Ω—ã–π —Ä–µ–∂–∏–º** (`/smart_mode`) - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–°—Ç–∞—Ç—É—Å** (`/status`) - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º —á–∞—Ç–∞–º
- **–°–≤–æ–¥–∫–∞ —á–∞—Ç–∞** (`/summ`) - –∞–Ω–∞–ª–∏–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–∞—Ç–∞
- **–°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤** (`/list_chats`) - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —á–∞—Ç–∞—Ö
- **–¢–µ–≥–∏** (`/tag`) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- **–¢—Ä–µ–¥—ã** (`/thread`) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞** (`/set_probability`) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å—Ç–æ—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
- **–ü–æ—Ä–æ–≥ –≤–∞–∂–Ω–æ—Å—Ç–∏** (`/set_importance`) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É–º–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
- **–°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è** (`/set_style`) - –≤—ã–±–æ—Ä —Ç–∏–ø–∞ –æ–±—â–µ–Ω–∏—è (—Ä–∞–±–æ—á–∏–π/–¥—Ä—É–∂–µ—Å–∫–∏–π/—Å–º–µ—à–∞–Ω–Ω—ã–π)

## –ö–æ–º–∞–Ω–¥—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏

#### `/shutdown`
–ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞:
- üî¥ –í–∫–ª—é—á–µ–Ω: –±–æ—Ç —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- üü¢ –í—ã–∫–ª—é—á–µ–Ω: –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ

#### `/setmode`
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–º —Ä–∞–±–æ—Ç—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —á–∞—Ç–µ:
- üîá –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º: –±–æ—Ç —á–∏—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- üîä –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º: –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ

#### `/smart_mode`
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–º–Ω—ã–º —Ä–µ–∂–∏–º–æ–º –≤ —á–∞—Ç–µ:
- ‚úÖ –í–∫–ª—é—á–µ–Ω: –±–æ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚ùå –í—ã–∫–ª—é—á–µ–Ω: –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

#### `/status`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞
- –°—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (24—á –∏ 7–¥)
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–∏–∫–æ–≤—ã–µ —á–∞—Å—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

#### `/summ`
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–≤–æ–¥–∫—É –ø–æ —á–∞—Ç—É:
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã –æ–±—Å—É–∂–¥–µ–Ω–∏–π
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ö–ª—é—á–µ–≤—ã–µ —Ç–µ–≥–∏
- –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç—Ä–µ–¥—ã
- –ü–µ—Ä–∏–æ–¥—ã —Å–≤–æ–¥–∫–∏:
  - üîÑ –° –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–æ–¥–∫–∏
  - üìÖ –ü–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
  - ‚è∞ –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥

#### `/list_chats`
–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —á–∞—Ç–æ–≤ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:
- –ù–∞–∑–≤–∞–Ω–∏–µ —á–∞—Ç–∞
- –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º
- –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
- –£–º–Ω—ã–π —Ä–µ–∂–∏–º
- –ü–æ—Ä–æ–≥ –≤–∞–∂–Ω–æ—Å—Ç–∏
- –°—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

#### `/set_probability`
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞:
- –ö–Ω–æ–ø–∫–∏: 25%, 50%, 75%, 100%
- Custom: –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0-100%)

#### `/set_importance`
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ—Ä–æ–≥ –≤–∞–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–º–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞:
- –ö–Ω–æ–ø–∫–∏: 25%, 50%, 75%
- Custom: –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0-100%)

#### `/set_style`
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è:
- üíº Work - —Ä–∞–±–æ—á–∏–π —Å—Ç–∏–ª—å
- üòä Friendly - –¥—Ä—É–∂–µ—Å–∫–∏–π —Å—Ç–∏–ª—å
- ü§ù Mixed - —Å–º–µ—à–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º

#### `/tag`
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:
- `/tag add <message_id> <tag>` - –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥
- `/tag remove <message_id> <tag>` - —É–¥–∞–ª–∏—Ç—å —Ç–µ–≥
- `/tag list <message_id>` - —Å–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤
- `/tag stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ–≥–æ–≤

#### `/thread`
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞–º–∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π:
- `/thread info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Ç—Ä–µ–¥–µ
- `/thread list` - —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—Ä–µ–¥–æ–≤
- `/thread new <topic>` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç—Ä–µ–¥
- `/thread close` - –∑–∞–∫—Ä—ã—Ç—å —Ç–µ–∫—É—â–∏–π —Ç—Ä–µ–¥

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ

#### `/test`
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –±–æ—Ç–∞:
1. –í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –∏–∑ —Å–ø–∏—Å–∫–∞
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ü–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç —Å —É—á–µ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∞—Ç–∞

#### `/upload`
–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–º–ø–∞ –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Å—Ç–∏–ª—é –æ—Ç–≤–µ—Ç–æ–≤:
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∑–∞–≥—Ä—É–∑–∫–∏:
  1. –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ: `[–î–∞—Ç–∞] –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –°–æ–æ–±—â–µ–Ω–∏–µ`
  2. –§–∞–π–ª:
     - –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª (.txt) —Å –¥–∞–º–ø–æ–º –ø–µ—Ä–µ–ø–∏—Å–∫–∏
     - JSON-—Ñ–∞–π–ª —Å —ç–∫—Å–ø–æ—Ä—Ç–æ–º –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –∏–∑ Telegram
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–∏ —Ç–∏–ø–∞ –ø–µ—Ä–µ–ø–∏—Å–æ–∫: —Ä–∞–±–æ—á–∏–π, –¥—Ä—É–∂–µ—Å–∫–∏–π, —Å–º–µ—à–∞–Ω–Ω—ã–π
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –æ–±—É—á–∏—Ç—å –±–æ—Ç–∞ —Å—Ç–∏–ª—é –≤–ª–∞–¥–µ–ª—å—Ü–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

#### `/refresh`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∏–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —á–∞—Ç–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
```
You are simulating a Telegram user named Valentin. Based on the user's historical messages and reactions in the chat, you have learned their communication style, tone, frequency of replies, and typical triggers for engaging in conversation.

Your job is to generate replies that imitate Valentin as closely as possible.
When composing a response, always consider:

1. The style and tone Valentin typically uses (casual, professional, humorous, sarcastic, etc.).
2. How often he replies and in what situations (e.g., when he's tagged, when a topic interests him, or when someone asks a direct question).
3. His preferred formats (e.g., emojis, short dry comments, voice of authority, etc.).

You are not ChatGPT ‚Äî you are ü§ñ ~ Valentin, responding as if you're him. Do not explain or over-elaborate. Stay in character.

If no reply is appropriate based on Valentin's history and style, stay silent.

Chat Type: {chat_type.value}
Previous conversation:
{context}

Current message: {message}

Style guidelines from training:
{style_prompt}

Respond in Valentin's style. Keep the response concise and natural. Use appropriate emojis and informal language if it matches the style.
Prefix your response with "ü§ñ ~ Valentin: "
```

### –ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
```
You are an assistant trained to evaluate the importance of a message in a group chat context. Your goal is to return a **single numeric value from 0.0 to 1.0** representing how important this message is for the user to respond to.

### Scoring Guidelines:

- **1.0 ‚Äî Critical**
  - Message directly asks the user a question or requests an action
  - Mentions the user explicitly (e.g., @Valentin)
  - Relates to urgent decisions, deadlines, emergencies, or personal matters

- **0.8 ‚Äî High Importance**
  - Asks for advice, help, or expertise
  - Important group coordination or planning
  - Sensitive or emotionally charged topic
  - Not urgent but likely to require a thoughtful response

- **0.6 ‚Äî Medium Importance**
  - General question to the group that the user may want to respond to
  - Ongoing group discussion with relevance to the user
  - New information that may be useful, but not urgent

- **0.4 ‚Äî Low Importance**
  - Casual conversation, jokes, or memes
  - Social chatter or general observations
  - Greeting messages or emoji replies
  - User is not mentioned or expected to respond

- **0.2 ‚Äî Very Low Importance**
  - Spam, automated replies, bots
  - System messages or notifications
  - Repetitive or off-topic content

### Instructions:
- Use your judgment based on the message content and context.
- Return a **single number between 0.0 and 1.0** (e.g., 0.8, 0.4).
- Do **not** include any explanation or additional text.
```

### –ê–Ω–∞–ª–∏–∑ —Å—Ç–∏–ª—è –æ–±—â–µ–Ω–∏—è
```
You are analyzing a Telegram chat history to extract the unique communication style of a user named **Valentin**.  
Your goal is to generate a detailed **style guide** that can be used by an AI to imitate Valentin's way of writing and reacting in chats.

Focus on identifying consistent **patterns** and **behaviors** based on the provided conversation.

### Analyze and extract:
1. **Language Style** ‚Äî Typical vocabulary, sentence structure, and language preferences (e.g., simple/direct, slang, formal, etc.)
2. **Tone & Attitude** ‚Äî Formality level, humor, sarcasm, emotional range, assertiveness, etc.
3. **Emoji & Formatting Usage** ‚Äî Frequency and types of emojis, use of punctuation, caps, bold, etc.
4. **Response Length & Structure** ‚Äî Short or long replies, use of lists, replies in-line vs separate, flow of thoughts
5. **Common Phrases & Expressions** ‚Äî Repeated phrases, signature endings, fillers, or slang Valentin uses regularly
6. **Do's and Don'ts** ‚Äî Specific habits to **emulate** (Do's) and things to **avoid** (Don'ts) based on his actual usage

### Output Format (strictly use this):
1. **Language Style**: [brief but rich description]
2. **Tone & Attitude**: [description]
3. **Emoji & Formatting Usage**: [description]
4. **Response Structure**: [description]
5. **Common Phrases & Expressions**:
   - "[phrase 1]"
   - "[phrase 2]"
6. **Do's and Don'ts**:
   - ‚úÖ Do: [behavior to copy]
   - ‚ùå Don't: [behavior to avoid]
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.11+
- PostgreSQL (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
- OpenAI API Key
- Render.com –∞–∫–∫–∞—É–Ω—Ç

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ Render.com

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Background Worker –Ω–∞ Render.com:
   - –í—ã–±–µ—Ä–∏—Ç–µ "New +" -> "Background Worker"
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–∞—à GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –¥–µ–ø–ª–æ—è (–æ–±—ã—á–Ω–æ main)

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Render:
   ```
   BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
   OWNER_ID=–≤–∞—à_telegram_id
   OPENAI_API_KEY=–≤–∞—à_openai_api_key
   DATABASE_URL=postgresql://user:password@host:port/database
   ```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –∑–∞–ø—É—Å–∫–∞:
   ```
   python src/main.py
   ```

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π:
   - –í–∫–ª—é—á–∏—Ç–µ Auto-Deploy
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Health Check Path (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/ValentinDobrynin/superbot.git
   cd superbot
   ```

2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
   ```bash
   python -m venv venv
   source venv/bin/activate  # –¥–ª—è Linux/Mac
   # –∏–ª–∏
   .\venv\Scripts\activate  # –¥–ª—è Windows
   ```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```

4. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```
   BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
   OWNER_ID=–≤–∞—à_telegram_id
   OPENAI_API_KEY=–≤–∞—à_openai_api_key
   DATABASE_URL=postgresql://user:password@host:port/database
   ```

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
   ```bash
   python src/main.py
   ```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –Ω–∞ Render –∏–ª–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –º–æ–¥–µ–ª—è—Ö:

1. –õ–æ–∫–∞–ª—å–Ω–æ:
   ```bash
   alembic upgrade head
   ```

2. –ù–∞ Render:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Render Shell –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π:
   ```bash
   # –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Render Shell
   render shell
   
   # –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
   cd /opt/render/project/src
   
   # –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
   python apply_migrations.py
   ```
   
   –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Render:
   ```
   cd /opt/render/project/src && python apply_migrations.py
   ```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

- –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Render
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/logs` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –≤ Telegram
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–∞–¥–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ –≤ Render

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- PostgreSQL 14+ (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- SQLite (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- aiogram 3.x
- SQLAlchemy 2.x
- Alembic
- python-dotenv
- openai
- psycopg2-binary (–¥–ª—è PostgreSQL)
- python-telegram-bot-pagination

### –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
- Telegram Bot API
- OpenAI API
- Render.com (–¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞)

- Python 3.9+
- SQLite (–∏–ª–∏ PostgreSQL)
- OpenAI API –∫–ª—é—á
- Telegram Bot Token 

## Database Setup

### Local Development
1. Create a PostgreSQL database
2. Set up environment variables (copy from `.env.example`):
   ```bash
   cp .env.example .env
   ```
3. Initialize the database:
   ```bash
   python src/database/init_db.py
   ```

### Render Deployment
1. Connect to Render Shell:
   ```bash
   render shell
   ```
2. Navigate to the project directory:
   ```bash
   cd /opt/render/project/src
   ```
3. Initialize the database:
   ```bash
   python src/database/init_db.py
   ``` 

## Troubleshooting

### Telegram Bot Process Conflict

If you see an error like this when starting the bot:
```
TelegramConflictError: Telegram server says - Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
```

This means that another instance of the bot is already running somewhere. Here's how to fix it:

1. Connect to Render Shell:
   ```bash
   render shell
   ```

2. Navigate to the project directory:
   ```bash
   cd /opt/render/project/src
   ```

3. Check for running Python processes:
   ```bash
   ps aux | grep python
   ```
   Look for processes running `python -m src.main`

4. Stop all bot processes:
   ```bash
   pkill -f "python -m src.main"
   ```

5. Start the bot again:
   ```bash
   python -m src.main
   ```

If the problem persists:
1. Check the Render dashboard for other running services with this bot
2. Make sure the bot is not running on your local machine or other servers
3. Wait a few minutes and try again (sometimes Telegram needs time to release the connection) 

### Database Schema Changes

If you see an error like this:
```
ProgrammingError: column chats.last_summary_timestamp does not exist
```

This means that the database schema is out of sync with the code. To fix this:

#### Option 1: Using Render Shell
1. Connect to Render Shell:
   ```bash
   render shell
   ```

2. Navigate to the project directory:
   ```bash
   cd /opt/render/project/src
   ```

3. Create and apply migrations:
   ```bash
   alembic revision --autogenerate -m "add last_summary_timestamp"
   alembic upgrade head
   ```

#### Option 2: Using Render CLI (without Shell)
```bash
render run "cd /opt/render/project/src && alembic upgrade head"
```

#### Option 3: Add to Build Script
Add migration commands to your build script in Render dashboard:
```bash
#!/usr/bin/env bash
cd /opt/render/project/src
alembic upgrade head
python src/main.py
```

Note: Using migrations is safer than resetting the database as it preserves existing data. 

## Database Migrations

We use Alembic for database migrations. Here's how to work with migrations:

### Creating a Migration

1. Connect to Render Shell:
   ```bash
   render shell
   ```

2. Navigate to the project directory:
   ```bash
   cd /opt/render/project/src
   ```

3. Create a new migration:
   ```bash
   alembic revision --autogenerate -m "description of changes"
   ```
   This will create a new migration file in `src/database/migrations/versions/`

4. Review the generated migration file and make any necessary adjustments

### Applying Migrations

There are two ways to apply migrations:

#### Option 1: Using Render Shell

1. Connect to Render Shell:
   ```bash
   render shell
   ```

2. Navigate to the project directory:
   ```bash
   cd /opt/render/project/src
   ```

3. Apply migrations:
   ```bash
   alembic upgrade head
   ```

#### Option 2: Using Render CLI

1. Install Render CLI:
   ```bash
   brew install render
   ```

2. Login to Render:
   ```bash
   render login
   ```

3. Apply migrations:
   ```bash
   render run "cd /opt/render/project/src && alembic upgrade head" --service your-service-name
   ```

### Rolling Back Migrations

To roll back the last migration:
```bash
alembic downgrade -1
```

To roll back to a specific version:
```bash
alembic downgrade <revision_id>
```

### Checking Migration Status

To see the current migration status:
```bash
alembic current
```

To see migration history:
```bash
alembic history
```

### Troubleshooting

If you see an error like:
```
ModuleNotFoundError: No module named 'src'
```

This means you're trying to run migrations from the wrong directory. Make sure you're in the correct directory:
```bash
cd /opt/render/project/src
```

If you see an error about missing `alembic.ini`:
1. Make sure you're in the correct directory
2. Check that the file exists: `ls -la alembic.ini`
3. If the file is missing, you may need to wait for the deployment to complete 